{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useShell = void 0;\nconst react_1 = require(\"react\");\nconst ssh2_1 = require(\"ssh2\");\nconst useShell = _ref => {\n  let {\n    config,\n    window,\n    onClose,\n    onConnect,\n    onData,\n    onError\n  } = _ref;\n  const [stream, setStream] = react_1.useState();\n  const connectConfig = Array.isArray(config) ? config : [config];\n  const clients = connectConfig.map(() => new ssh2_1.Client());\n  const handleError = error => {\n    if (onError) {\n      onError(error);\n    } else {\n      throw error;\n    }\n  };\n  const initShell = () => {\n    clients[0].on('error', handleError).connect(connectConfig[0]);\n    if (clients.length > 1) {\n      for (let i = 0; i < connectConfig.length - 1; i++) {\n        clients[i].on('ready', () => {\n          clients[i].forwardOut(connectConfig[i + 1].host || '', Math.floor(Math.random() * (65535 - 49152) + 49152), connectConfig[i + 1].host || '', connectConfig[i + 1].port || 22, (err, s) => {\n            if (err) {\n              if (onError) {\n                onError(err);\n              }\n              clients[i].end();\n            } else {\n              clients[i + 1].on('error', handleError).connect(Object.assign(Object.assign({}, connectConfig[i + 1]), {\n                sock: s\n              }));\n            }\n          });\n        });\n      }\n    }\n    clients[clients.length - 1].on('ready', () => {\n      clients[clients.length - 1].shell(window, (err, s) => {\n        if (err) {\n          if (onError) {\n            onError(err);\n          }\n          clients.length === 1 ? clients[0].end() : clients.forEach((c, index) => index < clients.length - 1 && c.end());\n        } else {\n          s.on('close', () => {\n            clients.forEach(c => c.end());\n            if (onClose) {\n              onClose();\n            }\n          }).on('data', data => {\n            if (onData) {\n              onData(data);\n            }\n          });\n          setStream(s);\n          if (onConnect) {\n            onConnect();\n          }\n        }\n      });\n    });\n  };\n  react_1.useEffect(() => {\n    return () => {\n      if (stream) {\n        stream.close();\n      }\n    };\n  }, []);\n  return {\n    initShell,\n    stream\n  };\n};\nexports.useShell = useShell;","map":{"version":3,"names":["Object","defineProperty","exports","value","useShell","react_1","require","ssh2_1","_ref","config","window","onClose","onConnect","onData","onError","stream","setStream","useState","connectConfig","Array","isArray","clients","map","Client","handleError","error","initShell","on","connect","length","i","forwardOut","host","Math","floor","random","port","err","s","end","assign","sock","shell","forEach","c","index","data","useEffect","close"],"sources":["C:/Users/hummas/Desktop/React/food-ordering-app/node_modules/react-ssh2-hook/dist/useShell.js"],"sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.useShell = void 0;\r\nconst react_1 = require(\"react\");\r\nconst ssh2_1 = require(\"ssh2\");\r\nconst useShell = ({ config, window, onClose, onConnect, onData, onError }) => {\r\n    const [stream, setStream] = react_1.useState();\r\n    const connectConfig = Array.isArray(config) ? config : [config];\r\n    const clients = connectConfig.map(() => new ssh2_1.Client());\r\n    const handleError = (error) => {\r\n        if (onError) {\r\n            onError(error);\r\n        }\r\n        else {\r\n            throw error;\r\n        }\r\n    };\r\n    const initShell = () => {\r\n        clients[0].on('error', handleError).connect(connectConfig[0]);\r\n        if (clients.length > 1) {\r\n            for (let i = 0; i < connectConfig.length - 1; i++) {\r\n                clients[i].on('ready', () => {\r\n                    clients[i].forwardOut(connectConfig[i + 1].host || '', Math.floor(Math.random() * (65535 - 49152) + 49152), connectConfig[i + 1].host || '', connectConfig[i + 1].port || 22, (err, s) => {\r\n                        if (err) {\r\n                            if (onError) {\r\n                                onError(err);\r\n                            }\r\n                            clients[i].end();\r\n                        }\r\n                        else {\r\n                            clients[i + 1].on('error', handleError).connect(Object.assign(Object.assign({}, connectConfig[i + 1]), { sock: s }));\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n        clients[clients.length - 1].on('ready', () => {\r\n            clients[clients.length - 1].shell(window, (err, s) => {\r\n                if (err) {\r\n                    if (onError) {\r\n                        onError(err);\r\n                    }\r\n                    clients.length === 1 ? clients[0].end() : clients.forEach((c, index) => index < clients.length - 1 && c.end());\r\n                }\r\n                else {\r\n                    s.on('close', () => {\r\n                        clients.forEach((c) => c.end());\r\n                        if (onClose) {\r\n                            onClose();\r\n                        }\r\n                    }).on('data', (data) => {\r\n                        if (onData) {\r\n                            onData(data);\r\n                        }\r\n                    });\r\n                    setStream(s);\r\n                    if (onConnect) {\r\n                        onConnect();\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    };\r\n    react_1.useEffect(() => {\r\n        return () => {\r\n            if (stream) {\r\n                stream.close();\r\n            }\r\n        };\r\n    }, []);\r\n    return { initShell, stream };\r\n};\r\nexports.useShell = useShell;\r\n"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,QAAQ,GAAG,KAAK,CAAC;AACzB,MAAMC,OAAO,GAAGC,OAAO,CAAC,OAAO,CAAC;AAChC,MAAMC,MAAM,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC9B,MAAMF,QAAQ,GAAGI,IAAA,IAA6D;EAAA,IAA5D;IAAEC,MAAM;IAAEC,MAAM;IAAEC,OAAO;IAAEC,SAAS;IAAEC,MAAM;IAAEC;EAAQ,CAAC,GAAAN,IAAA;EACrE,MAAM,CAACO,MAAM,EAAEC,SAAS,CAAC,GAAGX,OAAO,CAACY,QAAQ,EAAE;EAC9C,MAAMC,aAAa,GAAGC,KAAK,CAACC,OAAO,CAACX,MAAM,CAAC,GAAGA,MAAM,GAAG,CAACA,MAAM,CAAC;EAC/D,MAAMY,OAAO,GAAGH,aAAa,CAACI,GAAG,CAAC,MAAM,IAAIf,MAAM,CAACgB,MAAM,EAAE,CAAC;EAC5D,MAAMC,WAAW,GAAIC,KAAK,IAAK;IAC3B,IAAIX,OAAO,EAAE;MACTA,OAAO,CAACW,KAAK,CAAC;IAClB,CAAC,MACI;MACD,MAAMA,KAAK;IACf;EACJ,CAAC;EACD,MAAMC,SAAS,GAAGA,CAAA,KAAM;IACpBL,OAAO,CAAC,CAAC,CAAC,CAACM,EAAE,CAAC,OAAO,EAAEH,WAAW,CAAC,CAACI,OAAO,CAACV,aAAa,CAAC,CAAC,CAAC,CAAC;IAC7D,IAAIG,OAAO,CAACQ,MAAM,GAAG,CAAC,EAAE;MACpB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGZ,aAAa,CAACW,MAAM,GAAG,CAAC,EAAEC,CAAC,EAAE,EAAE;QAC/CT,OAAO,CAACS,CAAC,CAAC,CAACH,EAAE,CAAC,OAAO,EAAE,MAAM;UACzBN,OAAO,CAACS,CAAC,CAAC,CAACC,UAAU,CAACb,aAAa,CAACY,CAAC,GAAG,CAAC,CAAC,CAACE,IAAI,IAAI,EAAE,EAAEC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,IAAI,KAAK,GAAG,KAAK,CAAC,GAAG,KAAK,CAAC,EAAEjB,aAAa,CAACY,CAAC,GAAG,CAAC,CAAC,CAACE,IAAI,IAAI,EAAE,EAAEd,aAAa,CAACY,CAAC,GAAG,CAAC,CAAC,CAACM,IAAI,IAAI,EAAE,EAAE,CAACC,GAAG,EAAEC,CAAC,KAAK;YACtL,IAAID,GAAG,EAAE;cACL,IAAIvB,OAAO,EAAE;gBACTA,OAAO,CAACuB,GAAG,CAAC;cAChB;cACAhB,OAAO,CAACS,CAAC,CAAC,CAACS,GAAG,EAAE;YACpB,CAAC,MACI;cACDlB,OAAO,CAACS,CAAC,GAAG,CAAC,CAAC,CAACH,EAAE,CAAC,OAAO,EAAEH,WAAW,CAAC,CAACI,OAAO,CAAC5B,MAAM,CAACwC,MAAM,CAACxC,MAAM,CAACwC,MAAM,CAAC,CAAC,CAAC,EAAEtB,aAAa,CAACY,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;gBAAEW,IAAI,EAAEH;cAAE,CAAC,CAAC,CAAC;YACxH;UACJ,CAAC,CAAC;QACN,CAAC,CAAC;MACN;IACJ;IACAjB,OAAO,CAACA,OAAO,CAACQ,MAAM,GAAG,CAAC,CAAC,CAACF,EAAE,CAAC,OAAO,EAAE,MAAM;MAC1CN,OAAO,CAACA,OAAO,CAACQ,MAAM,GAAG,CAAC,CAAC,CAACa,KAAK,CAAChC,MAAM,EAAE,CAAC2B,GAAG,EAAEC,CAAC,KAAK;QAClD,IAAID,GAAG,EAAE;UACL,IAAIvB,OAAO,EAAE;YACTA,OAAO,CAACuB,GAAG,CAAC;UAChB;UACAhB,OAAO,CAACQ,MAAM,KAAK,CAAC,GAAGR,OAAO,CAAC,CAAC,CAAC,CAACkB,GAAG,EAAE,GAAGlB,OAAO,CAACsB,OAAO,CAAC,CAACC,CAAC,EAAEC,KAAK,KAAKA,KAAK,GAAGxB,OAAO,CAACQ,MAAM,GAAG,CAAC,IAAIe,CAAC,CAACL,GAAG,EAAE,CAAC;QAClH,CAAC,MACI;UACDD,CAAC,CAACX,EAAE,CAAC,OAAO,EAAE,MAAM;YAChBN,OAAO,CAACsB,OAAO,CAAEC,CAAC,IAAKA,CAAC,CAACL,GAAG,EAAE,CAAC;YAC/B,IAAI5B,OAAO,EAAE;cACTA,OAAO,EAAE;YACb;UACJ,CAAC,CAAC,CAACgB,EAAE,CAAC,MAAM,EAAGmB,IAAI,IAAK;YACpB,IAAIjC,MAAM,EAAE;cACRA,MAAM,CAACiC,IAAI,CAAC;YAChB;UACJ,CAAC,CAAC;UACF9B,SAAS,CAACsB,CAAC,CAAC;UACZ,IAAI1B,SAAS,EAAE;YACXA,SAAS,EAAE;UACf;QACJ;MACJ,CAAC,CAAC;IACN,CAAC,CAAC;EACN,CAAC;EACDP,OAAO,CAAC0C,SAAS,CAAC,MAAM;IACpB,OAAO,MAAM;MACT,IAAIhC,MAAM,EAAE;QACRA,MAAM,CAACiC,KAAK,EAAE;MAClB;IACJ,CAAC;EACL,CAAC,EAAE,EAAE,CAAC;EACN,OAAO;IAAEtB,SAAS;IAAEX;EAAO,CAAC;AAChC,CAAC;AACDb,OAAO,CAACE,QAAQ,GAAGA,QAAQ"},"metadata":{},"sourceType":"script","externalDependencies":[]}